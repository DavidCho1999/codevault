# CodeVault - Ontario Building Code ê²€ìƒ‰ ì„œë¹„ìŠ¤ êµ¬ì¡°

## í”„ë¡œì íŠ¸ ê°œìš”

| í•­ëª© | ë‚´ìš© |
|------|------|
| **í”„ë¡œì íŠ¸ëª…** | CodeVault |
| **ëª©ì ** | Ontario Building Code Part 9 ê²€ìƒ‰ ì„œë¹„ìŠ¤ |
| **íƒ€ê²Ÿ** | ê±´ì¶• ì „ë¬¸ê°€ (ê±´ì¶•ì‚¬, ì—”ì§€ë‹ˆì–´) |
| **ê¸°ìˆ  ìŠ¤íƒ** | Next.js 16 + Tailwind CSS + TypeScript |

---

## ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PDF ì›ë³¸                              â”‚
â”‚  source/2024 Building Code Compendium/301880.pdf            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼ Python + PyMuPDF
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PDF íŒŒì‹± ìŠ¤í¬ë¦½íŠ¸                          â”‚
â”‚  scripts_temp/parse_obc_v2.py                               â”‚
â”‚  - PDF TOC(ëª©ì°¨) ì½ê¸°                                        â”‚
â”‚  - ê° ì„¹ì…˜ë³„ í…ìŠ¤íŠ¸ ì¶”ì¶œ                                      â”‚
â”‚  - JSON íŒŒì¼ ìƒì„±                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼ JSON ì¶œë ¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°ì´í„° íŒŒì¼                                â”‚
â”‚  codevault/public/data/                                     â”‚
â”‚  â”œâ”€â”€ part9.json        (726KB) - ì „ì²´ ì½”ë“œ ë‚´ìš©              â”‚
â”‚  â”œâ”€â”€ toc.json          (31KB)  - ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜          â”‚
â”‚  â””â”€â”€ part9-index.json  (230KB) - ê²€ìƒ‰ ì¸ë±ìŠ¤                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼ Next.js SSG
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜                             â”‚
â”‚  codevault/                                                 â”‚
â”‚  â”œâ”€â”€ src/app/           - í˜ì´ì§€ ë¼ìš°íŠ¸                      â”‚
â”‚  â”œâ”€â”€ src/components/    - React ì»´í¬ë„ŒíŠ¸                     â”‚
â”‚  â””â”€â”€ src/lib/           - ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ë‹¨ê³„: PDF íŒŒì‹±

### ì›ë³¸ PDF
- **ê²½ë¡œ**: `source/2024 Building Code Compendium/301880.pdf`
- **ë‚´ìš©**: Ontario Building Code Volume 1 (Part 1-9)
- **Part 9 ìœ„ì¹˜**: í˜ì´ì§€ 711-986

### íŒŒì‹± ìŠ¤í¬ë¦½íŠ¸ (parse_obc_v2.py)

```python
import fitz  # PyMuPDF

# 1. PDF ì—´ê¸°
doc = fitz.open("301880.pdf")

# 2. ë‚´ì¥ TOC(ëª©ì°¨) ì¶”ì¶œ
toc = doc.get_toc()
# â†’ [("9.1. General", 715), ("9.1.1. Application", 715), ...]

# 3. ê° ì„¹ì…˜ì˜ í˜ì´ì§€ í…ìŠ¤íŠ¸ ì¶”ì¶œ
page = doc[page_num - 1]
text = page.get_text()

# 4. ê³„ì¸µ êµ¬ì¡°ë¡œ ì •ë¦¬
# Section (9.1) â†’ Subsection (9.1.1) â†’ Article (9.1.1.1)

# 5. JSON íŒŒì¼ ìƒì„±
json.dump(data, open("part9.json", "w"))
```

### í•µì‹¬ í•¨ìˆ˜ë“¤

| í•¨ìˆ˜ | ì—­í•  |
|------|------|
| `get_toc_part9()` | PDF TOCì—ì„œ Part 9 í•­ëª©ë§Œ í•„í„°ë§ |
| `parse_article_id()` | "9.10.3.1. Title" â†’ ("9.10.3.1", "Title") ë¶„ë¦¬ |
| `extract_page_text()` | íŠ¹ì • í˜ì´ì§€ í…ìŠ¤íŠ¸ ì¶”ì¶œ + í—¤ë”/í‘¸í„° ì œê±° |
| `build_structure()` | TOC ê¸°ë°˜ ê³„ì¸µ êµ¬ì¡° ìƒì„± |
| `create_search_index()` | ê²€ìƒ‰ìš© í‰ë¬¸ ì¸ë±ìŠ¤ ìƒì„± |

---

## 2ë‹¨ê³„: ë°ì´í„° êµ¬ì¡°

### part9.json (ì „ì²´ ì½”ë“œ ë‚´ìš©)

```json
{
  "id": "9",
  "title": "Housing and Small Buildings",
  "sections": [
    {
      "id": "9.10",
      "title": "Fire Protection",
      "page": 745,
      "subsections": [
        {
          "id": "9.10.1",
          "title": "Definitions and Application",
          "page": 745,
          "content": "9.10.1.1. Sloped Roofs\n(1) For the purposes of..."
        }
      ]
    }
  ]
}
```

### toc.json (ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜)

```json
[
  {
    "id": "9.1",
    "title": "General",
    "children": [
      { "id": "9.1.1", "title": "Application", "children": [] }
    ]
  },
  {
    "id": "9.10",
    "title": "Fire Protection",
    "children": [
      { "id": "9.10.1", "title": "Definitions and Application", "children": [] },
      { "id": "9.10.2", "title": "Occupancy Classification", "children": [] }
    ]
  }
]
```

### part9-index.json (ê²€ìƒ‰ ì¸ë±ìŠ¤)

```json
[
  {
    "id": "9.10.1",
    "title": "Definitions and Application",
    "section": "Fire Protection",
    "sectionId": "9.10",
    "content": "9.10.1.1. Sloped Roofs (1) For the purposes of...",
    "page": 745,
    "path": "/code/9.10.1"
  }
]
```

---

## 3ë‹¨ê³„: Next.js ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜

### í´ë” êµ¬ì¡°

```
codevault/
â”œâ”€â”€ public/
â”‚   â””â”€â”€ data/
â”‚       â”œâ”€â”€ part9.json
â”‚       â”œâ”€â”€ toc.json
â”‚       â””â”€â”€ part9-index.json
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ layout.tsx          # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ (Header + Sidebar)
â”‚   â”‚   â”œâ”€â”€ page.tsx            # í™ˆí˜ì´ì§€ (ì„¹ì…˜ ëª©ë¡)
â”‚   â”‚   â”œâ”€â”€ search/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx        # ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ code/
â”‚   â”‚       â””â”€â”€ [...section]/
â”‚   â”‚           â””â”€â”€ page.tsx    # ì½”ë“œ ì„¹ì…˜ ìƒì„¸ í˜ì´ì§€
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx      # ìƒë‹¨ í—¤ë” + ê²€ìƒ‰ë°”
â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx     # ì¢Œì¸¡ ë„¤ë¹„ê²Œì´ì…˜ íŠ¸ë¦¬
â”‚   â”‚   â””â”€â”€ code/
â”‚   â”‚       â””â”€â”€ SectionView.tsx # ì½”ë“œ ë‚´ìš© í¬ë§·íŒ…
â”‚   â”‚
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ types.ts            # TypeScript íƒ€ì… ì •ì˜
â”‚       â””â”€â”€ search.ts           # ê²€ìƒ‰ ë¡œì§
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ tailwind.config.js
â””â”€â”€ tsconfig.json
```

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸

#### Header.tsx
```tsx
// ë¡œê³  + ê²€ìƒ‰ë°” + ë¸Œëœë”©
<header>
  <Logo />
  <SearchBar onSearch={query => router.push(`/search?q=${query}`)} />
  <span>Ontario Building Code 2024</span>
</header>
```

#### Sidebar.tsx
```tsx
// ì¬ê·€ì  íŠ¸ë¦¬ ë„¤ë¹„ê²Œì´ì…˜
function TocNode({ item }) {
  const [isOpen, setIsOpen] = useState(false);
  return (
    <div>
      <button onClick={() => setIsOpen(!isOpen)}>{item.title}</button>
      {isOpen && item.children.map(child => <TocNode item={child} />)}
    </div>
  );
}
```

#### SectionView.tsx
```tsx
// ì½”ë“œ ë‚´ìš© í¬ë§·íŒ…
// "9.10.3.1. Title" â†’ <h3>9.10.3.1. Title</h3>
// "(1) Content..." â†’ <p>(1) Content...</p>
// "(a) Subclause" â†’ <p className="ml-8">(a) Subclause</p>
```

### ê²€ìƒ‰ ë¡œì§ (search.ts)

```typescript
export function searchCode(index: SearchItem[], query: string): SearchItem[] {
  const terms = query.toLowerCase().split(/\s+/);

  return index
    .map(item => {
      let score = 0;
      for (const term of terms) {
        if (item.id.includes(term)) score += 50;      // ID ë§¤ì¹­
        if (item.title.includes(term)) score += 30;   // ì œëª© ë§¤ì¹­
        if (item.content.includes(term)) score += 10; // ë‚´ìš© ë§¤ì¹­
      }
      return { item, score };
    })
    .filter(r => r.score > 0)
    .sort((a, b) => b.score - a.score)
    .map(r => r.item);
}
```

---

## 4ë‹¨ê³„: ë¼ìš°íŒ…

| URL | í˜ì´ì§€ | ë°ì´í„° |
|-----|--------|--------|
| `/` | í™ˆ | toc.json |
| `/code/9.10` | ì„¹ì…˜ | part9.json |
| `/code/9.10.1` | ì„œë¸Œì„¹ì…˜ | part9.json |
| `/search?q=fire` | ê²€ìƒ‰ ê²°ê³¼ | part9-index.json |

### ë™ì  ë¼ìš°íŠ¸ (code/[...section]/page.tsx)

```typescript
// /code/9/10/1 â†’ params.section = ["9", "10", "1"]
export default function CodePage({ params }) {
  const sectionId = params.section.join(".");  // "9.10.1"
  const content = findContent(sectionId);
  return <SectionView {...content} />;
}

// ë¹Œë“œ ì‹œ ëª¨ë“  ê²½ë¡œ ë¯¸ë¦¬ ìƒì„± (SSG)
export function generateStaticParams() {
  return part9Data.sections.flatMap(section => [
    { section: section.id.split(".") },
    ...section.subsections.map(sub => ({ section: sub.id.split(".") }))
  ]);
}
```

---

## UI ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [CV] CodeVault   [Search: _________________ ğŸ”]  OBC 2024      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚                                                 â”‚
â”‚ Part 9       â”‚  9.10 Fire Protection                          â”‚
â”‚              â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                â”‚
â”‚ â–¼ 9.1        â”‚                                                 â”‚
â”‚ â–¼ 9.10 â†     â”‚  9.10.1. Definitions and Application           â”‚
â”‚   â”œ 9.10.1   â”‚                                                 â”‚
â”‚   â”œ 9.10.2   â”‚  9.10.1.1. Sloped Roofs                        â”‚
â”‚   â”” 9.10.3   â”‚  (1) For the purposes of this Section...       â”‚
â”‚ â–¶ 9.11       â”‚                                                 â”‚
â”‚              â”‚                                                 â”‚
â”‚ [280px]      â”‚  [ë‚˜ë¨¸ì§€ ì˜ì—­]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë°ì´í„° íë¦„ ìš”ì•½

```
1. PDF ì›ë³¸
   â†“ PyMuPDF (fitz)
2. Python íŒŒì‹± ìŠ¤í¬ë¦½íŠ¸
   â†“ JSON ìƒì„±
3. ì •ì  JSON íŒŒì¼ (public/data/)
   â†“ Next.js import
4. React ì»´í¬ë„ŒíŠ¸
   â†“ ë Œë”ë§
5. ì‚¬ìš©ì ë¸Œë¼ìš°ì €
```

---

## ì‹¤í–‰ ë°©ë²•

```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰
cd codevault
npm run dev
# â†’ http://localhost:3000 (ë˜ëŠ” 3001)

# í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build

# PDF ì¬íŒŒì‹± (í•„ìš”ì‹œ)
cd scripts_temp
pip install pymupdf
python parse_obc_v2.py
```

---

## íŒŒì¼ í†µê³„

| í•­ëª© | ìˆ˜ì¹˜ |
|------|------|
| Part 9 ì„¹ì…˜ ìˆ˜ | 40ê°œ |
| Part 9 ì„œë¸Œì„¹ì…˜ ìˆ˜ | 255ê°œ |
| part9.json í¬ê¸° | 726KB |
| ê²€ìƒ‰ ì¸ë±ìŠ¤ í•­ëª© | 255ê°œ |
| ìƒì„±ëœ ì •ì  í˜ì´ì§€ | 300ê°œ |

---

## E2E í…ŒìŠ¤íŠ¸ ê²°ê³¼

| í…ŒìŠ¤íŠ¸ | ê²°ê³¼ |
|--------|------|
| í™ˆí˜ì´ì§€ ë¡œë“œ | âœ… |
| ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜ | âœ… |
| ê²€ìƒ‰ ê¸°ëŠ¥ | âœ… |
| ê²€ìƒ‰ ê²°ê³¼ â†’ ì„¹ì…˜ í˜ì´ì§€ | âœ… |
